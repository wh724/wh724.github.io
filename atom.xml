<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Space Port</title>
  
  <subtitle>welcome to my space station!</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://github.com/wh724/"/>
  <updated>2019-07-16T07:56:41.894Z</updated>
  <id>https://github.com/wh724/</id>
  
  <author>
    <name>WH</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>begining</title>
    <link href="https://github.com/wh724/2019/07/15/begining/"/>
    <id>https://github.com/wh724/2019/07/15/begining/</id>
    <published>2019-07-15T11:22:44.000Z</published>
    <updated>2019-07-16T07:56:41.894Z</updated>
    
    <content type="html"><![CDATA[<br>&emsp;&emsp; 记录自己的毕设出现的错误<a id="more"></a><p>&emsp;&emsp;  Faster RCNN+安全帽<br>使用教程：<a href="https://www.cnblogs.com/dudumiaomiao/p/6556111.html" target="_blank" rel="noopener">https://www.cnblogs.com/dudumiaomiao/p/6556111.html</a></p><!--more--><p>1.解决问题ImportError: cannot import name symbol_database</p><p><a href="https://blog.csdn.net/aBlueMouse/article/details/77744023" target="_blank" rel="noopener">https://blog.csdn.net/aBlueMouse/article/details/77744023</a></p><p>2.运行项目报错no model name _caffe</p><p>每次执行前必执行在py-faster-rcnn/caffe-faster-rcnn 目录下sudo make pycaffe</p><ol start="3"><li>字符编码不正确</li></ol><p>-<em>-  coding：utf-8 -</em>-</p><p>4.在训练stage1 rpn时，出现’numpy.float64’ object cannot be interpreted as an index 的提示错误，几乎所有的博客中都指出，需要更换numpy 的版本，照做之后，出现ImportError: numpy.core.multiarray failed to import，这个问题又是numpy不匹配造成的，这样就形成了恶性循环，所以，可以考虑从根源上解决’numpy.float64’ object cannot be interpreted as an index</p><p>TypeError: ‘numpy.float64’ object cannot be interpreted as an index</p><p>1) /home/xxx/py-faster-rcnn/lib/roi_data_layer/minibatch.py</p><p>将第26行：fg_rois_per_image = np.round(cfg.TRAIN.FG_FRACTION * rois_per_image)</p><p>改为：fg_rois_per_image = np.round(cfg.TRAIN.FG_FRACTION * rois_per_image).astype(np.int)</p><p>2) /home/xxx/py-faster-rcnn/lib/datasets/ds_utils.py</p><p>将第12行：hashes = np.round(boxes * scale).dot(v)</p><p>改为：hashes = np.round(boxes * scale).dot(v).astype(np.int)</p><p>3) /home/xxx/py-faster-rcnn/lib/fast_rcnn/test.py</p><p>将第129行： hashes = np.round(blobs[‘rois’] * cfg.DEDUP_BOXES).dot(v)</p><p>改为： hashes = np.round(blobs[‘rois’] * cfg.DEDUP_BOXES).dot(v).astype(np.int)</p><p>4) /home/xxx/py-faster-rcnn/lib/rpn/proposal_target_layer.py</p><p>将第60行：fg_rois_per_image = np.round(cfg.TRAIN.FG_FRACTION * rois_per_image)</p><p>改为：fg_rois_per_image = np.round(cfg.TRAIN.FG_FRACTION * rois_per_image).astype(np.int)</p><p>5.faster rcnn报错TypeError: slice indices must be integers or None or have an <strong>index</strong> method</p><p>改的是/home/xiaohua/py-faster-rcnn/lib/roi_data_layer下的minibatch.py文件转到172行，将</p><p>for ind in inds:</p><p>cls = clss[ind]</p><p>start = 4 * cls</p><p>end = start + 4</p><p>bbox_targets[ind, start:end] = bbox_target_data[ind, 1:]</p><p>bbox_inside_weights[ind, start:end] = cfg.TRAIN.BBOX_INSIDE_WEIGHTS</p><p>return bbox_targets, bbox_inside_weights</p><p>改为：</p><p>for ind in inds:</p><p>ind = int(ind)</p><p>cls = clss[ind]</p><p>start = int(4 * cos)</p><p>end = int(start + 4)</p><p>bbox_targets[ind, start:end] = bbox_target_data[ind, 1:]</p><p>bbox_inside_weights[ind, start:end] = cfg.TRAIN.BBOX_INSIDE_WEIGHTS</p><p>return bbox_targets, bbox_inside_weights</p><p>即可，自己注意python语法格式哦。</p><p>原文：<a href="https://blog.csdn.net/qq_27637315/article/details/78849756" target="_blank" rel="noopener">https://blog.csdn.net/qq_27637315/article/details/78849756</a></p><p>6。Check failed: error == cudaSuccess (2 vs. 0) out of memory6.</p><p>显存不足…经过查阅资料，有两种解决办法：</p><ol><li>安装cudnn</li></ol><p>解决办法看之前的博文：</p><p><a href="http://blog.csdn.net/u012283902/article/details/63254906" target="_blank" rel="noopener">http://blog.csdn.net/u012283902/article/details/63254906</a></p><p>由于是2G显存，还是不够用。可能这种方法比较适用于4G显存的情况下。</p><ol start="2"><li>修改配置文件</li></ol><p>/lib/fast_rcnn/config.py</p><p>（1）首先修改</p><h1 id="Minibatch-size-number-of-regions-of-interest-ROIs"><a href="#Minibatch-size-number-of-regions-of-interest-ROIs" class="headerlink" title="Minibatch size (number of regions of interest [ROIs])"></a>Minibatch size (number of regions of interest [ROIs])</h1><p>__C.TRAIN.BATCH_SIZE = 128</p><p>将这个值调小，比如64,32,16,8…..</p><p>进行训练看是否可行</p><p>(2)还可以修改</p><h1 id="Scales-to-use-during-training-can-list-multiple-scales"><a href="#Scales-to-use-during-training-can-list-multiple-scales" class="headerlink" title="Scales to use during training (can list multiple scales)"></a>Scales to use during training (can list multiple scales)</h1><h1 id="Each-scale-is-the-pixel-size-of-an-image’s-shortest-side"><a href="#Each-scale-is-the-pixel-size-of-an-image’s-shortest-side" class="headerlink" title="Each scale is the pixel size of an image’s shortest side"></a>Each scale is the pixel size of an image’s shortest side</h1><p>__C.TRAIN.SCALES = (600,)</p><p>将600改为，如500，400，300….等</p><p>查看效果</p><p>注意：不一定全更改，更改后可运行即可</p><p>原文：<a href="https://blog.csdn.net/u012283902/article/details/63255301" target="_blank" rel="noopener">https://blog.csdn.net/u012283902/article/details/63255301</a></p><p>7.pb2.text_format.Merge(f.read(), self.solver_param) AttributeError: ‘module’ object has no attribute ‘text_format’</p><p>经过google之后发现是protobuf的本版发生了变换，之前在配置caffe的时候手动安装了protbuf，版本是2.5.0，后来安装了tensorflow 我回忆了一下，protobuf的版本貌似是发生了变换。</p><p>所以解决办法：sudo pip install protobuf==2.5.0</p><p>刚才又发现一个新的解决方法：</p><p>在文件./lib/fast_rcnn/train.py增加一行import google.protobuf.text_format 即可解决问题</p><p>原文：<a href="https://blog.csdn.net/qq_33202928/article/details/72526710" target="_blank" rel="noopener">https://blog.csdn.net/qq_33202928/article/details/72526710</a></p><p>8.File”/home/gxjun/Qunar/py-faster-rcnn/tools/train_faster_rcnn_alt_opt.py”, line67,in get_roidb</p><pre><code>roidb = get_training_roidb(imdb)</code></pre><p>  File “/home/gxjun/Qunar/py-faster-rcnn/tools/../lib/fast_rcnn/train.py”, line118,in get_training_roidb</p><pre><code>imdb.append_flipped_images()</code></pre><p>  File “/home/gxjun/Qunar/py-faster-rcnn/tools/../lib/datasets/imdb.py”, line111,in append_flipped_images</p><pre><code>assert (boxes[:, 2] &gt;= boxes[:,0]).all()</code></pre><p>解决办法：将py-faster-rcnn/lib/datasets/imdb.py中的相应代码改成如下代码即可：</p><pre><code>def append_flipped_images(self):    num_images = self.num_images    widths = [PIL.Image.open(self.image_path_at(i)).size[0]              for i in xrange(num_images)]    for i in xrange(num_images):        boxes = self.roidb[i][&apos;boxes&apos;].copy()        oldx1 = boxes[:, 0].copy()        oldx2 = boxes[:, 2].copy()        boxes[:, 0] = widths[i] - oldx2 - 1        boxes[:, 2] = widths[i] - oldx1 - 1        for b in range(len(boxes)):            if boxes[b][2] &lt; boxes[b][0]:              boxes[b][0] = 0        assert (boxes[:, 2] &gt;= boxes[:, 0]).all()</code></pre><p>原文：<a href="https://blog.csdn.net/u014696921/article/details/60333805" target="_blank" rel="noopener">https://blog.csdn.net/u014696921/article/details/60333805</a></p><p>9.snapshot_prefix:”vgg16_rpn”average_loss: 100I0421 11:53:05.251756 24051 solver.cpp:81] Creating training netfromtrain_net file: models/pascal_voc/VGG16/faster_rcnn_alt_opt/stage1_rpn_train.pt</p><p>F0421 11:53:05.251797 24051 io.cpp:36] Check failed: fd != -1 (-1 vs. -1) Filenotfound: models/pascal_voc/VGG16/faster_rcnn_alt_opt/stage1_rpn_train.pt<strong>* Check failure stack trace: *</strong></p><p>将sovler.txt中的路径设置成绝对路径</p><p>9.error 2：IndexError: list index out of range</p><pre><code>File &quot;./tools/train_net.py&quot;, line 85, inroidb = get_training_roidb(imdb)File &quot;/usr/local/fast-rcnn/tools/../lib/fast_rcnn/train.py&quot;, line 111, in get_training_roidbrdl_roidb.prepare_roidb(imdb)File &quot;/usr/local/fast-rcnn/tools/../lib/roi_data_layer/roidb.py&quot;, line 23, in prepare_roidbroidb[i][&apos;image&apos;] = imdb.image_path_at(i)IndexError: list index out of range</code></pre><p>error2 解决办法：</p><p>删除fast-rcnn-master/data/cache/ 文件夹下的.pkl文件，或者改名备份，重新训练即</p><p>原文：<a href="https://blog.csdn.net/u014696921/article/details/60333805" target="_blank" rel="noopener">https://blog.csdn.net/u014696921/article/details/60333805</a></p><p>10.Cannot copy param 0 weights from layer ‘cls_score’; shape mismatch.</p><p>Source param shape is 21 4096 (86016); target param shape is 3 4096</p><p>(12288). To learn this layer’s parameters from scratch rather than</p><p>copying from a saved net, rename the layer.</p><p>这个错误要把对应的层rename。比如把cls_score改为cls_score1</p>]]></content>
    
    <summary type="html">
    
      &lt;br&gt;
&amp;emsp;&amp;emsp; 记录自己的毕设出现的错误
    
    </summary>
    
      <category term="编程" scheme="https://github.com/wh724/categories/%E7%BC%96%E7%A8%8B/"/>
    
    
      <category term="faster rcnn" scheme="https://github.com/wh724/tags/faster-rcnn/"/>
    
      <category term="深度学习" scheme="https://github.com/wh724/tags/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/"/>
    
  </entry>
  
  <entry>
    <title>Hello World</title>
    <link href="https://github.com/wh724/2019/07/15/hello-world/"/>
    <id>https://github.com/wh724/2019/07/15/hello-world/</id>
    <published>2019-07-15T03:53:41.527Z</published>
    <updated>2019-07-15T11:52:05.696Z</updated>
    
    <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/" target="_blank" rel="noopener">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html" target="_blank" rel="noopener">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p><a id="more"></a><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">"My New Post"</span></span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html" target="_blank" rel="noopener">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html" target="_blank" rel="noopener">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html" target="_blank" rel="noopener">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/deployment.html" target="_blank" rel="noopener">Deployment</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Welcome to &lt;a href=&quot;https://hexo.io/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Hexo&lt;/a&gt;! This is your very first post. Check &lt;a href=&quot;https://hexo.io/docs/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;documentation&lt;/a&gt; for more info. If you get any problems when using Hexo, you can find the answer in &lt;a href=&quot;https://hexo.io/docs/troubleshooting.html&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;troubleshooting&lt;/a&gt; or you can ask me on &lt;a href=&quot;https://github.com/hexojs/hexo/issues&quot;&gt;GitHub&lt;/a&gt;.&lt;/p&gt;
    
    </summary>
    
    
  </entry>
  
</feed>
